<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kwitariusz - System ZarzƒÖdzania P≈Çatno≈õci</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --color-primary: #667eea;
            --color-secondary: #764ba2;
            --color-bg: #f5f5f5;
            --color-surface: #ffffff;
            --color-text: #333;
            --color-text-light: #999;
            --color-border: #e0e0e0;
        }
        
        body.dark-mode {
            --color-bg: #1a1a1a;
            --color-surface: #2d2d2d;
            --color-text: #e0e0e0;
            --color-text-light: #aaa;
            --color-border: #444;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--color-bg);
            color: var(--color-text);
            transition: all 0.3s;
        }
        
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 250px;
            height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            overflow-y: auto;
            z-index: 1000;
            display: flex;
            flex-direction: column;
        }
        
        .sidebar-header {
            margin-bottom: 30px;
        }
        
        .sidebar h1 {
            font-size: 18px;
            font-weight: 600;
        }
        
        .sidebar-nav {
            flex: 1;
        }
        
        .sidebar a {
            display: block;
            padding: 12px 15px;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }
        
        .sidebar a:hover {
            background: rgba(255,255,255,0.2);
            transform: translateX(5px);
        }
        
        .sidebar a.active {
            background: rgba(255,255,255,0.3);
            font-weight: 600;
        }
        
        main {
            margin-left: 250px;
            padding: 30px;
            min-height: 100vh;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            background: var(--color-surface);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .section {
            display: none;
        }
        
        .section.active {
            display: block;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .form-container {
            background: var(--color-surface);
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--color-border);
            border-radius: 5px;
            background: var(--color-surface);
            color: var(--color-text);
        }
        
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .btn-primary:hover {
            background: #5568d3;
        }
        
        .btn-secondary {
            background: #e0e0e0;
            color: #333;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .btn-danger {
            background: #ff6b6b;
            color: white;
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--color-border);
        }
        
        th {
            font-weight: 600;
            background: var(--color-bg);
        }
        
        .table-container {
            background: var(--color-surface);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.show {
            display: flex;
        }
        
        .modal-content {
            background: var(--color-surface);
            border-radius: 10px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--color-text-light);
        }
        
        .modal-footer {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            justify-content: flex-end;
        }
        
        .warning-box {
            font-size: 12px;
            color: #ff6b6b;
            margin: 15px 0;
            padding: 10px;
            background: rgba(255,107,107,0.1);
            border-radius: 5px;
            border-left: 3px solid #ff6b6b;
        }
    </style>
</head>
<body>
    <aside class="sidebar">
        <div class="sidebar-header">
            <h1>üìä Kwitariusz</h1>
        </div>
        
        <nav class="sidebar-nav">
            <a class="nav-item active" data-section="dashboard">üìä Dashboard</a>
            <a class="nav-item" data-section="placowka">üè¢ Dane Plac√≥wki</a>
            <a class="nav-item" data-section="grupy">üë• Grupy</a>
            <a class="nav-item" data-section="rodzice">üë®üë© Rodzice</a>
            <a class="nav-item" data-section="dzieci">üëß Dzieci</a>
            <a class="nav-item" data-section="stawki">üí∞ Stawki</a>
            <a class="nav-item" data-section="platnosci">üí≥ P≈Çatno≈õci</a>
        </nav>
    </aside>

    <main>
        <div class="header">
            <h2 id="page-title">üìä Dashboard</h2>
            <button class="theme-toggle" id="themeToggle">üåô</button>
        </div>

        <!-- DANE PLAC√ìWKI -->
        <section id="placowka" class="section">
            <div class="form-container">
                <h3>Dane Plac√≥wki</h3>
                <form id="placowkaForm">
                    <div class="form-group">
                        <label>Nazwa Plac√≥wki *</label>
                        <input type="text" id="placowkaNazwa" required>
                    </div>
                    <div class="form-group">
                        <label>Adres</label>
                        <input type="text" id="placowkaAdres">
                    </div>
                    <div class="form-group">
                        <label>Telefon</label>
                        <input type="tel" id="placowkaTelefon">
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="placowkaEmail">
                    </div>
                    <button type="submit" class="btn-primary">Zapisz</button>
                </form>
            </div>
        </section>

        <!-- GRUPY -->
        <section id="grupy" class="section">
            <button class="btn-primary" id="addGroupBtn">+ Dodaj Grupƒô/Klasƒô</button>
            <div class="table-container">
                <h3>Grupy/Klasy</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Nazwa</th>
                            <th>Opis</th>
                            <th>Akcje</th>
                        </tr>
                    </thead>
                    <tbody id="groupsTable">
                        <tr><td colspan="3">Brak grup</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- RODZICE -->
        <section id="rodzice" class="section">
            <button class="btn-primary" id="addParentBtn">+ Dodaj Rodzica</button>
            <div class="table-container">
                <h3>Rodzice</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Imiƒô</th>
                            <th>Nazwisko</th>
                            <th>Telefon</th>
                            <th>Email</th>
                            <th>Akcje</th>
                        </tr>
                    </thead>
                    <tbody id="parentsTable">
                        <tr><td colspan="5">Brak rodzic√≥w</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- DZIECI -->
        <section id="dzieci" class="section">
            <button class="btn-primary" id="addChildBtn">+ Dodaj Dziecko</button>
            <div class="table-container">
                <h3>Dzieci</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Imiƒô</th>
                            <th>Nazwisko</th>
                            <th>Klasa</th>
                            <th>Rodzice</th>
                            <th>Akcje</th>
                        </tr>
                    </thead>
                    <tbody id="childrenTable">
                        <tr><td colspan="5">Brak dzieci</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- STAWKI -->
        <section id="stawki" class="section">
            <button class="btn-primary" id="addRateBtn">+ Dodaj Stawkƒô</button>
            <div class="table-container">
                <h3>Stawki</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Grupa</th>
                            <th>Kategoria</th>
                            <th>Kwota</th>
                            <th>Akcje</th>
                        </tr>
                    </thead>
                    <tbody id="ratesTable">
                        <tr><td colspan="4">Brak stawek</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- P≈ÅATNO≈öCI -->
        <section id="platnosci" class="section">
            <button class="btn-primary" id="addPaymentBtn">+ Dodaj P≈Çatno≈õƒá</button>
            <div class="table-container">
                <h3>P≈Çatno≈õci</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Rodzic</th>
                            <th>Dziecko</th>
                            <th>Kwota</th>
                            <th>Data</th>
                            <th>Akcje</th>
                        </tr>
                    </thead>
                    <tbody id="paymentsTable">
                        <tr><td colspan="5">Brak p≈Çatno≈õci</td></tr>
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <!-- MODAL: Rodzic -->
    <div id="addParentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Dodaj Rodzica</h2>
                <button class="close-btn" onclick="closeModal('addParentModal')">‚úï</button>
            </div>
            <form id="addParentForm">
                <div class="warning-box">
                    <strong>‚ö†Ô∏è Wymagane pola:</strong> Imiƒô, Nazwisko, Telefon, Email
                </div>
                <div class="form-group">
                    <label>Imiƒô *</label>
                    <input type="text" id="parentFirstName" required>
                </div>
                <div class="form-group">
                    <label>Nazwisko *</label>
                    <input type="text" id="parentLastName" required>
                </div>
                <div class="form-group">
                    <label>Telefon *</label>
                    <input type="tel" id="parentPhone" required>
                </div>
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" id="parentEmail" required>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn-secondary" onclick="closeModal('addParentModal')">Anuluj</button>
                    <button type="submit" class="btn-primary">Dodaj</button>
                </div>
            </form>
        </div>
    </div>

    <!-- MODAL: Dziecko -->
    <div id="addChildModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Dodaj Dziecko</h2>
                <button class="close-btn" onclick="closeModal('addChildModal')">‚úï</button>
            </div>
            <form id="addChildForm">
                <div class="warning-box">
                    <strong>‚ö†Ô∏è Wymagane pola:</strong> Imiƒô, Nazwisko, Klasa, G≈Ç√≥wny rodzic
                </div>
                <div class="form-group">
                    <label>Imiƒô *</label>
                    <input type="text" id="childFirstName" required>
                </div>
                <div class="form-group">
                    <label>Nazwisko *</label>
                    <input type="text" id="childLastName" required>
                </div>
                <div class="form-group">
                    <label>Klasa *</label>
                    <select id="childGroup" required>
                        <option value="">-- Wybierz klasƒô --</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>G≈Ç√≥wny rodzic *</label>
                    <select id="childParent1" required>
                        <option value="">-- Wybierz rodzica --</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Drugi rodzic (opcjonalnie)</label>
                    <select id="childParent2">
                        <option value="">-- Brak --</option>
                    </select>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn-secondary" onclick="closeModal('addChildModal')">Anuluj</button>
                    <button type="submit" class="btn-primary">Dodaj</button>
                </div>
            </form>
        </div>
    </div>

    <!-- MODAL: Grupa -->
    <div id="addGroupModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Dodaj Grupƒô/Klasƒô</h2>
                <button class="close-btn" onclick="closeModal('addGroupModal')">‚úï</button>
            </div>
            <form id="addGroupForm">
                <div class="form-group">
                    <label>Nazwa *</label>
                    <input type="text" id="groupName" required>
                </div>
                <div class="form-group">
                    <label>Opis</label>
                    <input type="text" id="groupDescription">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn-secondary" onclick="closeModal('addGroupModal')">Anuluj</button>
                    <button type="submit" class="btn-primary">Dodaj</button>
                </div>
            </form>
        </div>
    </div>

    <script>
let parents = [];
let children = [];
let groups = [];

const isElectron = typeof window !== 'undefined' && typeof window.ipcRenderer !== 'undefined';

// ============ MODAL FUNCTIONS ============
function openModal(id) {
    document.getElementById(id).classList.add('show');
}

function closeModal(id) {
    document.getElementById(id).classList.remove('show');
}

document.querySelectorAll('.modal').forEach(modal => {
    modal.addEventListener('click', (e) => {
        if (e.target === modal) modal.classList.remove('show');
    });
});

// ============ NAVIGATION ============
document.querySelectorAll('.nav-item').forEach(item => {
    item.addEventListener('click', (e) => {
        e.preventDefault();
        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        
        item.classList.add('active');
        const id = item.getAttribute('data-section');
        document.getElementById(id).classList.add('active');
        document.getElementById('page-title').textContent = item.textContent;
        
        if (id === 'rodzice') loadParents();
        if (id === 'dzieci') loadChildren();
        if (id === 'grupy') loadGroups();
        if (id === 'placowka') loadPlacowka();
    });
});

// ============ PLAC√ìWKA ============
async function loadPlacowka() {
    try {
        if (isElectron && window.ipcRenderer) {
            const data = await window.ipcRenderer.invoke('getPlacowka');
            if (data) {
                document.getElementById('placowkaNazwa').value = data.nazwa || '';
                document.getElementById('placowkaAdres').value = data.adres || '';
                document.getElementById('placowkaTelefon').value = data.telefon || '';
                document.getElementById('placowkaEmail').value = data.email || '';
            }
        }
    } catch (error) {
        console.error('Error:', error);
    }
}

document.getElementById('placowkaForm')?.addEventListener('submit', async (e) => {
    e.preventDefault();
    const data = {
        nazwa: document.getElementById('placowkaNazwa').value,
        adres: document.getElementById('placowkaAdres').value,
        telefon: document.getElementById('placowkaTelefon').value,
        email: document.getElementById('placowkaEmail').value
    };
    
    try {
        if (isElectron && window.ipcRenderer) {
            await window.ipcRenderer.invoke('addPlacowka', data);
        }
        alert('‚úÖ Dane plac√≥wki zapisane!');
    } catch (error) {
        alert('‚ùå B≈ÇƒÖd: ' + error.message);
    }
});

// ============ GRUPY ============
async function loadGroups() {
    try {
        if (isElectron && window.ipcRenderer) {
            groups = await window.ipcRenderer.invoke('getGrupy', 1);
        }
        renderGroups();
        populateGroupSelect();
    } catch (error) {
        console.error('Error:', error);
    }
}

function renderGroups() {
    const tbody = document.getElementById('groupsTable');
    if (groups.length === 0) {
        tbody.innerHTML = '<tr><td colspan="3">Brak grup</td></tr>';
        return;
    }
    tbody.innerHTML = groups.map(g => `
        <tr>
            <td>${g.nazwa}</td>
            <td>${g.opis || '-'}</td>
            <td><button class="btn-danger" onclick="deleteGroup(${g.id})">Usu≈Ñ</button></td>
        </tr>
    `).join('');
}

function populateGroupSelect() {
    const select = document.getElementById('childGroup');
    select.innerHTML = '<option value="">-- Wybierz klasƒô --</option>';
    groups.forEach(g => {
        const opt = document.createElement('option');
        opt.value = g.id;
        opt.textContent = g.nazwa;
        select.appendChild(opt);
    });
}

document.getElementById('addGroupBtn')?.addEventListener('click', () => {
    openModal('addGroupModal');
});

document.getElementById('addGroupForm')?.addEventListener('submit', async (e) => {
    e.preventDefault();
    const data = {
        placowka_id: 1,
        nazwa: document.getElementById('groupName').value,
        opis: document.getElementById('groupDescription').value
    };
    
    try {
        if (isElectron && window.ipcRenderer) {
            const result = await window.ipcRenderer.invoke('addGrupa', data);
            data.id = result.lastInsertRowid;
        } else {
            data.id = groups.length + 1;
        }
        groups.push(data);
        closeModal('addGroupModal');
        loadGroups();
        alert('‚úÖ Grupa dodana!');
    } catch (error) {
        alert('‚ùå B≈ÇƒÖd: ' + error.message);
    }
});

async function deleteGroup(id) {
    if (confirm('UsunƒÖƒá?')) {
        try {
            if (isElectron && window.ipcRenderer) {
                await window.ipcRenderer.invoke('deleteGrupa', id);
            }
            groups = groups.filter(g => g.id !== id);
            loadGroups();
        } catch (error) {
            console.error('Error:', error);
        }
    }
}

// ============ RODZICE ============
async function loadParents() {
    try {
        if (isElectron && window.ipcRenderer) {
            parents = await window.ipcRenderer.invoke('getRodzice', 1);
        }
        renderParents();
        populateParentSelects();
    } catch (error) {
        console.error('Error:', error);
    }
}

function renderParents() {
    const tbody = document.getElementById('parentsTable');
    if (parents.length === 0) {
        tbody.innerHTML = '<tr><td colspan="5">Brak rodzic√≥w</td></tr>';
        return;
    }
    tbody.innerHTML = parents.map(p => `
        <tr>
            <td>${p.imie}</td>
            <td>${p.nazwisko}</td>
            <td>${p.telefon || '-'}</td>
            <td>${p.email || '-'}</td>
            <td><button class="btn-danger" onclick="deleteParent(${p.id})">Usu≈Ñ</button></td>
        </tr>
    `).join('');
}

function populateParentSelects() {
    const s1 = document.getElementById('childParent1');
    const s2 = document.getElementById('childParent2');
    
    s1.innerHTML = '<option value="">-- Wybierz rodzica --</option>';
    s2.innerHTML = '<option value="">-- Brak --</option>';
    
    parents.forEach(p => {
        const o1 = document.createElement('option');
        o1.value = p.id;
        o1.textContent = `${p.imie} ${p.nazwisko}`;
        s1.appendChild(o1);
        
        const o2 = document.createElement('option');
        o2.value = p.id;
        o2.textContent = `${p.imie} ${p.nazwisko}`;
        s2.appendChild(o2);
    });
}

document.getElementById('addParentBtn')?.addEventListener('click', () => {
    document.getElementById('addParentForm').reset();
    openModal('addParentModal');
});

document.getElementById('addParentForm')?.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const firstName = document.getElementById('parentFirstName').value.trim();
    const lastName = document.getElementById('parentLastName').value.trim();
    const phone = document.getElementById('parentPhone').value.trim();
    const email = document.getElementById('parentEmail').value.trim();
    
    if (!firstName || !lastName || !phone || !email) {
        alert('‚ö†Ô∏è Wype≈Çnij wszystkie wymagane pola!');
        return;
    }
    
    const data = {
        placowka_id: 1,
        imie: firstName,
        nazwisko: lastName,
        telefon: phone,
        email: email,
        adres: '',
        miasto: '',
        kod_pocztowy: ''
    };
    
    try {
        if (isElectron && window.ipcRenderer) {
            const result = await window.ipcRenderer.invoke('addRodzic', data);
            data.id = result.lastInsertRowid;
        } else {
            data.id = parents.length + 1;
        }
        parents.push(data);
        closeModal('addParentModal');
        loadParents();
        alert('‚úÖ Rodzic dodany!');
    } catch (error) {
        alert('‚ùå B≈ÇƒÖd: ' + error.message);
    }
});

async function deleteParent(id) {
    if (confirm('UsunƒÖƒá?')) {
        try {
            if (isElectron && window.ipcRenderer) {
                await window.ipcRenderer.invoke('deleteRodzic', id);
            }
            parents = parents.filter(p => p.id !== id);
            loadParents();
        } catch (error) {
            console.error('Error:', error);
        }
    }
}

// ============ DZIECI ============
async function loadChildren() {
    try {
        if (isElectron && window.ipcRenderer) {
            children = await window.ipcRenderer.invoke('getDzieci');
        }
        renderChildren();
    } catch (error) {
        console.error('Error:', error);
    }
}

function renderChildren() {
    const tbody = document.getElementById('childrenTable');
    if (children.length === 0) {
        tbody.innerHTML = '<tr><td colspan="5">Brak dzieci</td></tr>';
        return;
    }
    tbody.innerHTML = children.map(c => {
        const p1 = parents.find(p => p.id === c.rodzic_id);
        const p2 = c.rodzic_id_2 ? parents.find(p => p.id === c.rodzic_id_2) : null;
        const g = groups.find(g => g.id === c.grupa_id);
        
        let pText = p1 ? `${p1.imie} ${p1.nazwisko}` : '-';
        if (p2) pText += `, ${p2.imie} ${p2.nazwisko}`;
        
        return `
            <tr>
                <td>${c.imie}</td>
                <td>${c.nazwisko}</td>
                <td>${g ? g.nazwa : '-'}</td>
                <td>${pText}</td>
                <td><button class="btn-danger" onclick="deleteChild(${c.id})">Usu≈Ñ</button></td>
            </tr>
        `;
    }).join('');
}

document.getElementById('addChildBtn')?.addEventListener('click', () => {
    if (parents.length === 0) {
        alert('‚ö†Ô∏è Dodaj najpierw rodzica!');
        return;
    }
    document.getElementById('addChildForm').reset();
    populateParentSelects();
    openModal('addChildModal');
});

document.getElementById('addChildForm')?.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const firstName = document.getElementById('childFirstName').value.trim();
    const lastName = document.getElementById('childLastName').value.trim();
    const classId = document.getElementById('childGroup').value;
    const parent1Id = document.getElementById('childParent1').value;
    const parent2Id = document.getElementById('childParent2').value || null;
    
    if (!firstName) {
        alert('‚ö†Ô∏è Wpisz imiƒô dziecka!');
        return;
    }
    if (!lastName) {
        alert('‚ö†Ô∏è Wpisz nazwisko dziecka!');
        return;
    }
    if (!classId) {
        alert('‚ö†Ô∏è Wybierz klasƒô!');
        return;
    }
    if (!parent1Id) {
        alert('‚ö†Ô∏è Wybierz g≈Ç√≥wnego rodzica!');
        return;
    }
    
    const data = {
        rodzic_id: parseInt(parent1Id),
        rodzic_id_2: parent2Id ? parseInt(parent2Id) : null,
        grupa_id: parseInt(classId),
        imie: firstName,
        nazwisko: lastName,
        data_urodzenia: ''
    };
    
    try {
        if (isElectron && window.ipcRenderer) {
            const result = await window.ipcRenderer.invoke('addDziecko', data);
            data.id = result.lastInsertRowid;
        } else {
            data.id = children.length + 1;
        }
        children.push(data);
        closeModal('addChildModal');
        loadChildren();
        alert('‚úÖ Dziecko dodane!');
    } catch (error) {
        alert('‚ùå B≈ÇƒÖd: ' + error.message);
    }
});

async function deleteChild(id) {
    if (confirm('UsunƒÖƒá?')) {
        try {
            if (isElectron && window.ipcRenderer) {
                await window.ipcRenderer.invoke('deleteDziecko', id);
            }
            children = children.filter(c => c.id !== id);
            loadChildren();
        } catch (error) {
            console.error('Error:', error);
        }
    }
}

// ============ INIT ============
document.addEventListener('DOMContentLoaded', () => {
    loadGroups();
});

// ============ THEME ============
document.getElementById('themeToggle')?.addEventListener('click', () => {
    document.body.classList.toggle('dark-mode');
    localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
    updateTheme();
});

function updateTheme() {
    const toggle = document.getElementById('themeToggle');
    if (toggle) {
        toggle.textContent = document.body.classList.contains('dark-mode') ? '‚òÄÔ∏è' : 'üåô';
    }
}

if (localStorage.getItem('theme') === 'dark') {
    document.body.classList.add('dark-mode');
}
updateTheme();
    </script>
</body>
</html>
